function FindApi(){this._applicationUrl="/",this._serviceApiBaseUrl="",this._trackId="",this._trackParam="_t_",this._dontTrackQueryParam="_t_dtq",this._allowTrackingCookieName=null,this._bufferTrackRequest=!0,this.setApplicationUrl=function(t){this._applicationUrl=t},this.setServiceApiBaseUrl=function(t){this._serviceApiBaseUrl=t},this.setAllowTrackingCookieName=function(t){this._allowTrackingCookieName=t},this.setTrackParam=function(t){this._trackParam=t},this.setDontTrackQueryParam=function(t){this._dontTrackQueryParam=t},this.bindWindowEvents=function(){var t=this;window.history&&(window.onbeforeunload=function(){var e=document.location.href;e.indexOf("q=")>0&&-1==e.indexOf(t._dontTrackQueryParam+"=")&&window.history.replaceState(window.history.state,window.document.title,e+(e.indexOf("?")>0?"&":"?")+t._dontTrackQueryParam+"=true")}),window.addEventListener("load",function(){var e=t._toArray(document.getElementsByTagName("A")),r=document.createElement("A");r.href=document.location.href;for(var n=0;e.length>n;n++){var i=function(){for(var i=!1,o=e[n].href,a=t._getTrackQueryParamsFromUrl(o),s=0;a.trackQueryParams.length>s;s++)if(0==a.trackQueryParams[s].indexOf("id")){i=!0;break}if(a.trackQueryParams.length>0&&i){var u=document.createElement("A");u.href=o,("/"!=t._applicationUrl&&r.hostname+t._applicationUrl!=u.hostname+"/"+u.pathname.split("/")[1]+"/"||"/"===t._applicationUrl)&&(e[n].href=t._getUriWithoutTrackParams(o,a),$(e[n]).on("mousedown",function(e){$(this).on("mouseup",function(r){if(e.target==r.target&&e.which==r.which&&(1==r.which||2==r.which)){$(this).off("mousedown mouseup");var n=t._constructTrackUrl(a.trackQueryParams);t._sendEvent(n)}})}))}};i()}},!1)},this.bindAClickEvent=function(){},this._getUriWithoutTrackParams=function(t,e){return e.trackQueryParams.length>0&&e.nonTrackQueryParams.length>0?t.split("?")[0]+"?"+e.nonTrackQueryParams.join("&"):e.trackQueryParams.length>0?t.split("?")[0]:void 0},this._getTrackQueryParamsFromUrl=function(t){var e=t.split("?")[1]||"",r=e.split("&"),n=[],i=[];this._bufferTrackRequest=!0;for(var o=0;r.length>o;o++){var a=r[o].split("=");if(decodeURIComponent(a[0])==this._dontTrackQueryParam&&"true"==a[1]&&(this._bufferTrackRequest=!1),decodeURIComponent(a[0]).slice(0,this._trackParam.length)==this._trackParam){var s=decodeURIComponent(a[0]).slice(this._trackParam.length);n.push(encodeURIComponent(s)+"="+a[1])}else i.push(r[o])}return{trackQueryParams:n,nonTrackQueryParams:i}},this._constructTrackUrl=function(t){return this._serviceApiBaseUrl+"_track?"+t.join("&")},this.processEventFromCurrentUri=function(){var t=document.location.href,e=this._getTrackQueryParamsFromUrl(t);e.trackQueryParams.length>0&&(this._bufferTrackRequest&&this._bufferEvent(this._constructTrackUrl(e.trackQueryParams)),window.history&&window.history.replaceState(window.history.state,window.document.title,this._getUriWithoutTrackParams(t,e)))},this._toArray=function(t){var e=[];if(!t||!t.length)return e;for(var r=0;t.length>r;r++)r in t&&e.push(t[r]);return e},this._getCookies=function(t,e){var r,n,i,o=[],a=document.cookie.split(";");for(r=0;a.length>r&&(n=a[r].substr(0,a[r].indexOf("=")),n=n.replace(/^\s+|\s+$/g,""),t&&!t(n)||(i=a[r].substr(a[r].indexOf("=")+1),o.push({name:n,value:decodeURIComponent(i)}),!e||0!==--e));r++);return o},this._getCookie=function(t){var e=this._getCookies(function(e){return t===e},1);return e.length?e[0].value:void 0},this._setCookie=function(t,e,r){var n=new Date;n.setDate(n.getDate()+r),e=encodeURIComponent(e)+"; Path=/"+(null===r?"":"; expires="+n.toUTCString()),document.cookie=t+"="+e},this._deleteCookie=function(t){document.cookie=t+"=; Path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"},this._debug=function(t){window.console&&console.log(t)},this._getBufferedEvents=function(){return this._getCookies(function(t){return 0===t.indexOf("_findEvent")})},this._bufferEvent=function(t){this._setCookie("_findEvent"+this._createUUID(),t,3650)},this._deleteBufferedEvent=function(t){this._deleteCookie(t)},this.sendBufferedEvents=function(){for(var t=this._getBufferedEvents(),e=0;t.length>e;e++)this._sendEvent(t[e].value),this._deleteBufferedEvent(t[e].name)},this._sendEvent=function(t){if(window.fetch)return fetch(t,{method:"GET",keepalive:!0,headers:{Accept:"application/json"}}).then(function(t){return t.json()}).then(function(t){return t}).catch(function(t){return t}),void 0;if(window.XMLHttpRequest){var e=new XMLHttpRequest;if("withCredentials"in e)return e.open("GET",t,!1),e.send(),void 0}if(window.XDomainRequest){var r=new XDomainRequest;return r.open("GET",t),r.send(),void 0}var n=new Image(1,1);n.src=t},this._createUUID=function(){for(var t="",e=this._PRNG();32>t.length;t+=Math.floor(4294967295*e()).toString(16));return[t.substr(0,8),t.substr(8,4),"4"+t.substr(12,3),"89AB"[Math.floor(4*Math.random())]+t.substr(16,3),t.substr(20,12)].join("-")},this._PRNG=function(){return function(t){var e=0,r=0,n=0,i=1,o=[],a=0,s=4022871197,u=function(t){t=""+t;for(var e=0;t.length>e;e++){s+=t.charCodeAt(e);var r=.02519603282416938*s;s=r>>>0,r-=s,r*=s,s=r>>>0,r-=s,s+=4294967296*r}return 2.3283064365386963e-10*(s>>>0)};e=u(" "),r=u(" "),n=u(" ");for(var c=0;8>c;c++)o[c]=u(" ");0===t.length&&(t=[+new Date]);for(var h=0;t.length>h;h++)for(e-=u(t[h]),0>e&&(e+=1),r-=u(t[h]),0>r&&(r+=1),n-=u(t[h]),0>n&&(n+=1),c=0;8>c;c++)o[c]-=u(t[h]),0>o[c]&&(o[c]+=1);var f=function(){var t=2091639;a=0|8*o[a];var s=o[a],u=t*e+2.3283064365386963e-10*i;return e=r,r=n,n=u-(i=0|u),o[a]-=n,0>o[a]&&(o[a]+=1),s};return f.uint32=function(){return 4294967296*f()},f.fract53=function(){return f()+1.1102230246251565e-16*(0|2097152*f())},f.addNoise=function(){for(var t=arguments.length-1;t>=0;t--)for(c=0;8>c;c++)o[c]-=u(arguments[t]),0>o[c]&&(o[c]+=1)},f.version="Kybos 0.9",f.args=t,f}(Array.prototype.slice.call(arguments))}}